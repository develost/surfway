<application>
    <name>Lessons example v 0.0.1</name>
    <folder>../application</folder>
    <publicUrl>http://localhost:18080/application</publicUrl>
    <connections>
        <connection>
            <id>dblessons</id>
            <type>mysql</type>
            <host>localhost</host>
            <username>root</username>
            <password>pwd</password>
            <db>lessonsdb</db>
            <connectionString></connectionString>
            <fileName></fileName>
        </connection>
    </connections>
    <authentication>
        <type>tablePlain</type>
        <connectionId>dblessons</connectionId>
        <tableName>users</tableName>
        <userIdAttribute>id</userIdAttribute>
        <userNameAttribute>email</userNameAttribute>
        <passwordAttribute>password</passwordAttribute>
        <filter>locked = 0 and disabled = 0</filter>
    </authentication>
    <tables>
        <table>
            <connectionId>dblessons</connectionId>
            <name>teachers</name>            
            <alias>Teachers</alias>
            <icon>./images/teachers.png</icon>
            <description>All teachers</description>
            <order>3</order>
            <authorization>edit</authorization>
            <visualization>
                <type>icons</type>
                <pk>id</pk>
                <pkType>number</pkType>
                <icon>'./images/teachers.png'</icon>
                <title>last_name</title>
                <description>first_name</description>
                <orderBy>last_name, first_name</orderBy>
            </visualization>
            <attributes>
                <attribute>
                    <name>first_name</name>
                    <nativeType>string</nativeType>
                    <alias>Forename</alias>
                    <order>2</order>
                    <showType>text</showType>
                    <showTypeParams></showTypeParams>
                    <modType>text</modType>
                    <modTypeConnectionId></modTypeConnectionId>
                    <modTypeParams></modTypeParams>
                </attribute>
                <attribute>
                    <name>last_name</name>
                    <nativeType>string</nativeType>
                    <alias>Surname</alias>
                    <order>1</order>
                    <showType>text</showType>
                    <showTypeParams></showTypeParams>
                    <modType>text</modType>
                    <modTypeConnectionId></modTypeConnectionId>
                    <modTypeParams></modTypeParams>
                </attribute>
            </attributes>
        </table>
        <table>
            <connectionId>dblessons</connectionId>
            <name>students</name>            
            <alias>Students</alias>
            <icon>./images/students.png</icon>
            <description>All students</description>
            <order>2</order>
            <authorization>edit</authorization>            
            <visualization>
                <type>icons</type>
                <pk>id</pk>
                <pkType>number</pkType>
                <icon>'./images/students.png'</icon>
                <title>last_name</title>
                <description>first_name</description>
                <orderBy>last_name, first_name</orderBy>                
            </visualization>
            <attributes>
                <attribute>
                    <name>first_name</name>
                    <nativeType>string</nativeType>
                    <alias>Forename</alias>
                    <order>2</order>
                    <showType>text</showType>
                    <showTypeConnectionId></showTypeConnectionId>
                    <showTypeParams></showTypeParams>
                    <modType>text</modType>
                    <modTypeConnectionId></modTypeConnectionId>
                    <modTypeParams></modTypeParams>
                </attribute>
                <attribute>
                    <name>last_name</name>
                    <nativeType>string</nativeType>
                    <alias>Surname</alias>
                    <order>1</order>
                    <showType>text</showType>
                    <showTypeConnectionId></showTypeConnectionId>
                    <showTypeParams></showTypeParams>
                    <modType>text</modType>
                    <modTypeConnectionId></modTypeConnectionId>
                    <modTypeParams></modTypeParams>
                </attribute>
            </attributes>
        </table>
        <table>
            <connectionId>dblessons</connectionId>
            <name>lessons</name>            
            <alias>Lessons</alias>
            <icon>./images/lessons.png</icon>
            <description>All lessons</description>
            <order>1</order>
            <authorization>edit</authorization>            
            <visualization>
                <type>gantt</type>
                <pk>id</pk>
                <pkType>number</pkType>                
                <rowTitle>(select concat(last_name,' ',first_name) from teachers where id = id_teacher limit 1)</rowTitle>
                <rowOrder>desc</rowOrder>
                <itemStartTime>start_time</itemStartTime>
                <itemEndTime>addtime(start_time,sec_to_time(duration*60*60))</itemEndTime>
                <itemLabel>(select concat(last_name,' ',first_name) from students where id = id_student limit 1)</itemLabel>
                <minPeriod>1sec</minPeriod>
                <maxPeriod>100years</maxPeriod>
                <startPeriod>1week</startPeriod>
            </visualization>
            <attributes>
                <attribute>
                    <name>duration</name>
                    <nativeType>number</nativeType>
                    <alias>Lesson duration</alias>
                    <order>4</order>
                    <showType>text</showType>
                    <showTypeConnectionId></showTypeConnectionId>
                    <showTypeParams></showTypeParams>
                    <modType>text</modType>
                    <modTypeConnectionId></modTypeConnectionId>
                    <modTypeParams></modTypeParams>
                </attribute>
                <attribute>
                    <name>start_time</name>
                    <nativeType>string</nativeType>
                    <alias>Lesson starts</alias>
                    <order>3</order>
                    <showType>text</showType>
                    <showTypeConnectionId></showTypeConnectionId>
                    <showTypeParams></showTypeParams>
                    <modType>text</modType>
                    <modTypeConnectionId></modTypeConnectionId>
                    <modTypeParams>date('Y-m-d').' 12:00:00'</modTypeParams>
                </attribute>
                <attribute>
                    <name>id_teacher</name>
                    <nativeType>number</nativeType>
                    <alias>Techer</alias>
                    <order>1</order>
                    <showType>lookup</showType>
                    <showTypeConnectionId>dblessons</showTypeConnectionId>
                    <showTypeParams>select concat(last_name,' ',first_name) from teachers where id = /*SUBSTITUTEVALUE*/ limit 1</showTypeParams>
                    <modType>combobox</modType>
                    <modTypeConnectionId>dblessons</modTypeConnectionId>
                    <modTypeParams>select id, concat(last_name,' ',first_name) from teachers order by last_name, first_name</modTypeParams>
                </attribute>
                <attribute>
                    <name>id_student</name>
                    <nativeType>number</nativeType>
                    <alias>Student</alias>
                    <order>2</order>
                    <showType>lookup</showType>
                    <showTypeConnectionId>dblessons</showTypeConnectionId>
                    <showTypeParams>select concat(last_name,' ',first_name) from students where id = /*SUBSTITUTEVALUE*/ limit 1</showTypeParams>
                    <modType>combobox</modType>
                    <modTypeConnectionId>dblessons</modTypeConnectionId>
                    <modTypeParams>select id as value, concat(last_name,' ',first_name) as description from students order by last_name, first_name</modTypeParams>
                </attribute>
                <attribute>
                    <name>subject</name>
                    <nativeType>string</nativeType>
                    <alias>Subject</alias>
                    <order>5</order>
                    <showType>text</showType>
                    <showTypeConnectionId></showTypeConnectionId>
                    <showTypeParams></showTypeParams>
                    <modType>text</modType>
                    <modTypeConnectionId></modTypeConnectionId>
                    <modTypeParams></modTypeParams>
                </attribute>                
            </attributes>
        </table>
        <table>
            <connectionId>dblessons</connectionId>
            <name>report_1</name>            
            <alias>Monthly report</alias>
            <icon>./images/lessons.png</icon>
            <description>Monthly lesson of a student</description>
            <order>4</order>
            <authorization>show</authorization>            
            <visualization>
                <type>table</type>
                <pk>id</pk>
                <pkType>number</pkType>
                <filters>
                    <filter>
                        <onAttribute>year_start_time</onAttribute>
                        <nativeType>string</nativeType>                        
                        <operator>eq</operator>
                        <description>Year</description>
                        <order>2</order>
                        <modType>text</modType>
                        <modTypeConnectionId></modTypeConnectionId>
                        <modTypeParams>date('Y')</modTypeParams>
                    </filter>                 
                    <filter>
                        <onAttribute>month_start_time</onAttribute>
                        <nativeType>string</nativeType>                        
                        <operator>eq</operator>
                        <description>Month</description>
                        <order>3</order>
                        <modType>combobox</modType>
                        <modTypeConnectionId>dblessons</modTypeConnectionId>
                        <modTypeParams>select id as value, name as description from month_names order by id</modTypeParams>
                    </filter>                
                    <filter>
                        <onAttribute>id_student</onAttribute>
                        <nativeType>number</nativeType>                        
                        <operator>eq</operator>
                        <description>Student</description>
                        <order>1</order>
                        <modType>combobox</modType>
                        <modTypeConnectionId>dblessons</modTypeConnectionId>
                        <modTypeParams>select id as value, concat(last_name,' ',first_name) as description from students order by last_name, first_name</modTypeParams>
                    </filter>
                </filters>
                <columns>
                    <column>
                        <name>subject</name>
                        <alias>Subject</alias>
                        <order>4</order>
                        <width>100</width>
                    </column>
                    <column>
                        <name>duration</name>
                        <alias>Duration</alias>
                        <order>2</order>
                        <width>40</width>
                    </column>                    
                    <column>
                        <name>start_time</name>
                        <alias>Lesson starts</alias>
                        <order>1</order>
                        <width>120</width>
                    </column>
                    <column>
                        <name>teacher</name>
                        <alias>Teacher</alias>
                        <order>3</order>
                        <width>80</width>
                    </column>
                    <column>
                        <name>student</name>
                        <alias>Student</alias>
                        <order>5</order>
                        <width>80</width>
                    </column>                    
                </columns>
                <orderBy>start_time</orderBy>
            </visualization>
            <attributes>
                <attribute>
                    <name>id</name>
                    <nativeType>number</nativeType>
                    <alias>id</alias>
                    <order>1</order>
                    <showType>text</showType>
                    <showTypeConnectionId></showTypeConnectionId>
                    <showTypeParams></showTypeParams>
                    <modType>text</modType>
                    <modTypeConnectionId></modTypeConnectionId>
                    <modTypeParams></modTypeParams>
                </attribute>
            </attributes>
        </table> 
    </tables>
</application>
